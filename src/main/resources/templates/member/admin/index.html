<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head th:replace="/layout/basic :: head"></head>
<body>
<!-- warpper start -->
<div class="wrapper">
  <div th:replace="/layout/basic :: sidebar">

  </div>

  <!-- content start -->
  <div class="content">
    <div th:replace="/layout/basic :: navbar"></div>

    <div class="inner-content" style="margin:4%; max-width: 80%;">

      <h2 style="display: inline-flex">행정 관리</h2>
      <button style="display: inline-flex" class="btn btn-primary float-end" onclick="location.href='/member/admin/insert'"> 행정 등록 </button>


      <!-- 검색 -->


      <div class="row mt-3" style="max-width: 500px">
        <form action="/member/admin" method="get">
          <div class="col">
            <input type="hidden" name="size" th:value="${pageRequestDTO.size}">
            <div class="input-group">
              <div class="input-group-prepend">
                <select class="form-select" name="type">
                  <option value="">---</option>
                  <option th:selected="${pageRequestDTO.type == 'n'}" value="n">이름</option>
                  <option th:selected="${pageRequestDTO.type == 'i'}" value="i">아이디</option>
                  <option th:selected="${pageRequestDTO.type == 'ni'}" value="ni">이름/아이디</option>
                </select>
              </div>

              <input type="text" class="form-control" name="keyword" th:value="${pageRequestDTO.keyword}">
              <div class="input-group-append">
                <button type="submit" class="btn btn-info searchBtn">검색</button>
                <button type="button" class="btn btn-secondary clearBtn">초기화</button>
              </div>

            </div>
          </div>

        </form>
      </div>


      <!-- 검색 끝-->


      <div th:each="member : ${pageResponseDTO.getDtoList()}" th:with="admin=${admin}">

            <hr>
            <img class="rounded-circle" th:src="@{/img/{fileName}(fileName=${member.getFileName()})}" alt="" style="width: 40px; height: 40px;">
            <div style="display: inline-flex" th:text="${member.name}"></div>
            <div class="float-end">
              <button style="display: inline-flex" class="btn btn-secondary" th:data-name="${member.id}" th:onclick="adminUpdate(this.getAttribute('data-name'))">수정</button>
              <button style="display: inline-flex" class="btn btn-danger" th:data-name="${member.id}" th:onclick="admindelete(this.getAttribute('data-name'))">삭제</button>
            </div>

      </div>

      <br>
      <br>
      <div class="float-end">
        <ul class="pagination flex-wrap">
          <li class="page-item" th:if="${pageResponseDTO.prev}">
            <a class="page-link" th:data-num="${pageResponseDTO.start -1}">이전</a>
          </li>

          <th:block th:each="i : ${#numbers.sequence(pageResponseDTO.start, pageResponseDTO.end)}">
            <li th:class="${pageResponseDTO.page == i} ? 'page-item active' : 'page-item'">
              <a class="page-link" th:data-num="${i}" >[[${i}]]</a>
            </li>
          </th:block>

          <li class="page-item" th:if="${pageResponseDTO.next}">
            <a class="page-link" th:data-num="${pageResponseDTO.end + 1}">다음</a>
          </li>

        </ul>
      </div>


    </div>





  </div>
  <!-- content end -->


  <!-- 진짜 개 천천히 top으로 올라가네요-->
  <a th:replace="/layout/basic :: back-to-top"></a>

</div>
<!-- wrapper end-->



<div th:replace="/layout/basic :: scriptSet">
</div>

<script>
  function adminDelete(memberId) {
    if(confirm('삭제하시겠습니까?')){
      location.href='/member/admin/delete?id=' + memberId;
    }
  }


  function adminUpdate(memberId) {
    location.href='/member/admin/update?id=' + memberId;
  }

</script>
</body>
</html>